## 10.07.2019

- cache
  - 특징
    - 정적파일은 자동으로 cache처리 되지만 동적렌더링이 필요한 api에서는 cache기능이 활성화되지 않아있다
    - 유저 입장에서 빠른속도로 데이터를 받아올 수 있다.
  - redis
  - memcached
  - http
    - 특징
      - api같이 언제 바뀔지 모른느 데이터의 cache는 쉽지 않지만 이 방식을 이용하면 서버에서 새로운 데이터를 먼저 확인하고 줄 수 있어 api에서도 충분히 적용가능하다.
      - 다른방식보다 먼저 사용해보는게 좋다.
      - db 부하를 줄일 수 있고 response 데이터를 받아오지 않아 속도개선이 좋다.
    - 종류
      - cache control + expire
        - `Cache-Control: public, max-age=31536000`
        - `max-age`동안 브라우저가 cache를 해도 무방하다고 알려주는 방식이다.
        - api의 경우 언제 새로운 데이터가 포함될지 모르니 이 방식을 사용할 수 없다.
      - last modified
        - `Last-Modified: Mon, 03 Jan 2011 17:45:57 GMT`
        - api의 내용이 마지막으로 변경된 시간을 response로 주면 브라우저에서는 request header에 약간의 정보를 아래와 같이 추가해서 보낸다.
        - `If-Modified-Since: Mon, 03 Jan 2011 17:45:57 GMT`
        - api 핸들러에서 마지막으로 변경된 시간을 체크해서 아직 안바뀐 경우 304를 주면 브라우저는 이전 cache데이터를 사용한다.
        - 만약 db에서 마지막 변경시간을 관리하고 있을시 이 방식을 사용하기에 적합하다.
      - etag
        - `ETag: "15f0fff99ed5aae4edffdd6496d7131f"`
        - last-modified방식과 거의 동일하다.
        - 시간 대신 hash값을 사용한다는 점이 다르다.
        - response데이터의 md5 hash를 보통 사용한다.
        - response에 etag header를 추가하면 아래와 같이 request header에 추가된다.
        - `If-None-Match: "15f0fff99ed5aae4edffdd6496d7131f"`
        - 동일한 etag를 가지고 있을시 304를 리턴한다.
        - db부하를 줄일 순 없지만 reponse시간을 줄이는데 도움을 준다.
