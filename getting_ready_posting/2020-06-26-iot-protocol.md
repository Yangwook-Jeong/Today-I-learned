---
layout: post
title: IoT에서 사용하는 프로토콜 한 눈에 보기
author: Yangeok
categories: IoT
date: 2020-06-26 09:00
comments: true
tags: [iot, protocol]
cover: https://res.cloudinary.com/yangeok/image/upload/v1593160497/logo/posts/iot-protocol.jpg
---


# IOT FIRE DETECTOR V5

## [TECHNOLOGIES](https://bit.ly/2V9R4vh)

### P2P
간단히 2대의 디바이스가 직접 연결되어 통신하는 것을 의미한다. 보통 2대만 P2P 통신에 참여할 수 있다.

- Bluetooth Classic:  가장 잘 알려진 P2P 기술이다. 작동 거리가 비교적 짧기때문에 꽤나 적은 전원을 사용한다. WiFi와 셀룰러 기술에 비해 더 적은 전원을 소비한다. 하지만 BLE나 Zigbee보다는 더 많이 소모한다.

- WiFi Direct: 모든 휴대폰 태블릿도 지원하긴 WiFi와 마찬가지기는 하다. 블루투스처럼, 전통적인 WiFi와는 달리 WiFi Direct는 P2P 기술이다. 전통적인 WiFi는 여러대의 디바이스를 연결하기 위한 AP를 설치한다. 하지만 한 대의 디바이스에서 다른 디바이스로 오버헤드 없이 곧바로 데이터를 전송하고 싶은 경우 사용할 수 있다. 전통적인 WiFi와 같은 기반기술을 사용하며 같은 주파수와 비슷한 대역과 속도를 제공한다. 하지만 AP가 필요하지 않고 블루투스와 비슷하게 2대의 디바이스를 곧바로 연결하는게 가능하다. 블루투스보다 100배 이상 전송속도가 빠른 장점이 있다. 속도가 빠른만큼 비용이, 즉 전원소비가 더 발생하긴 한다.

- NFC(Near-Field Communication): 근본적으로 다른 무선 통신들과는 다르다. 2개의 코일간에서 발생하는 전자기장을 사용해 통신한다. 그에 반해 다른 무선 통신 기술은 전파를 통해 통신한다. NFC가 전자기장으로 연결된 2개의 코일을 통해 통신하기때문에 작동거리가 1~2인치 가량 남짓밖에 되지 않는다. 2개의 연결된 코일은 원래 공심을 가진 도란스의 형태를 띄고 있다. 보통 비접촉 결제 시스템에 많이 사용한다. 결제 데이터가 암호화되긴 하지만 짧은 작동거리는 누군가가 가까이서 거래를 해킹할 가능성을 제거하는데 도움이 된다. 패시브 NFC 태그를 사용하는데, 여기서 패시브란 무전원을 말한다. 대신 패시브 태그는 NFC 리더 기기의 전자기장에서 전원을 공급받는다. 양 쪽의 통신과 전원의 이동은 연결된 2개의 코일 사이에서 발생한다. 패시브 태그는 간단하고, 저렴하고, 작고, 영구성을 갖는다. 배터리를 포함한 액티브 태그를 사용할 수도 있다. 충전매트에 디바이스를 올려놓는 무선충전도 2개의 연결된 코일 사이에엇 전원을 이동시키는 현상의 이점을 가져온 것이다.

### 저전력/단거리/저용량 데이터 매쉬형
제품에 배터리가 있다면 비교적 적은 양의 데이터를 단거리로 보내는데 필요하다면 아래의 프로토콜이 최고의 솔루션이다. 망사형 네트워크라고 불리는 다대다 네트워크를 사용한다. 망사형 네트워크는 B를 거쳐 A에서 C로 데이터를 보낸다. 서로 연결된 디바이스들을 넓은 영역을 저전력으로 커버할 수 있는 거대한 네트워크를 만들 수 있다. 예를 들어 A부터 Z까지 라벨링된 26대의 디바이스가 기기마다 30미터씩 간격으로 한 줄로 세워놨다고 가정해보자. 2,500미터 떨어진 A부터 Z까지 데이터를 보내고 싶은 경우에는 전원이 있는 중계기가 필요할 것이다. 하지만 망사형 네트워크에서는 A에서 B로, B에서 C 식으로 Z까지 데이터를 전달할 수 있다. 300미터 이상되는 거리를 중계기가 필요없이 각 디바이스마다 중계기보다 더 적은 전원만 있으면 된다.

- BLE(Bluetooth Low-Energy): Bluetooth Classic의 저전력 버전이다. 사실 일반적인 블루투스와는 용도가 완전히 다르다. 아마 BLE는 개발한 제품들이 가진 무선 기능의 일반적인 타입일 것이다. 전력소모를 극단적으로 줄이기 위해 데이터의 송수신을 하기위해 디자인되었다. BLE의 용도는 대부분 센서 데이터를 전달하기 위함이다. 예를 들어, 센서 디바이스는 분 단위로 온도를 측정한다거나 GPS 디바이스는 10분 단위로 위치를 기록하고 전달할 수 있다. 대부분 BLE는 작은 셀 배터리로부터 전원을 공급받는다. BLE 디바이스의 배터리를 오래 보전하기 위해서는 데이터 전송 빈도를 느슨하게 잡아야 한다. BLE는 제품을 이상적인 솔루션으로 만들기 위해 모바일앱으로 접속할 수 있는 휴대폰과 태블릿을 지원한다. 1Mbps까지 전송속도를 지원한다. (Bluetooth Classic은 2~3Mbps까지) 이 섹션의 기술들이 그렇듯, BLE는 망사형 네트워크와 그에 연결할 수 있는 32,767대의 기기까지 지원한다. 사용하기가 쉽고 전력 소비량이 적으며 광범위하게 지원하기때문에 추천하는 기술이다.

- Zigbee: BLE와 용도가 여러모로 비슷한 단거리 네트워킹 기술이다. 마찬가지로 2.4GHz 주파수를 사용하고, 전력 소모량이 적고, BLE와 비슷한 통신거리를 지원하며 망사형 네트워크를 제공한다. 다만 BLE의 2배인 65,000대의 디바이스를 망사형 네트워크에 포함시킬 수 있다. 다만 응용에는 아직까지는 한계가 있는 것으로 보인다. 우선적으로 스마트 조명, 온도조절, 에너지 모니터링같은 용도로 홈 오토메이션 애플리케이션에 사용된다. 또한 산업 자동화, 스마트 미터, 보안 시스템에서도 사용하고 있다.

- Z-Wave: Zigbee, BLE와 홈 오토메이션 시장에서 경쟁하는 독점 무선 기술(Silicon Labs에서 2018년부터)이다. Zigbee, BLE와는 달리 Sub-1GHz 주파수를 사용한다. 정확한 대역은 복잡한 이유로 나라마다 각기 다르다. 미국에서는 908MHz를 그에 반해 유럽에서는 868MHz를 사용한다. 다른 국가와 지역은 모두 865~921MHz 사이에서 사용한다. 저주파는 통신 거리를 증가시키고 간섭을 줄이는 2개의 장점이 있다. BLE, Zigbee, WiFi 등에 쓰이는 2.4GHz 주파수는 잠재적으로 간섭이 발생할 가능성이 있다. Z-Wave가 사용하는 주파수는 상대적으로 덜 혼잡하지만 BLE보다 10배 느린 낮은 데이터 전송속도가 느린 점이 단점이다. 232대의 다비이스를 연결하는 적은 망사형 네트워크를 지원한다.

- 6LoWPAN: 기술의 이름에서 6은 IPv6에서 LoWPAN(Low-power Wireless Personal Area Network)은 저전력 개인통신망을 의마한다. 원래는 Zigbee의 새로운 경쟁자였지만 WiFi같은 IP기반 네트워크이다. Zigbee, Z-Wave, 6LoPWAN은 주로 홈 오토메이션 애플리케이션, 스마트 미터에서 사용한다.

### LAN
LAN의 커버리지 영역때문에 WiFi = LAN이라고 알려져있다. 

- WiFi: 빠르고, 저렴하고, 설치하기 쉬운 WiFi는 괜찮은 통신거리를 가지고 있으며 광범위하게 사용가능하다. 가장 큰 단점은 적어도 모바일 제품에서만 사용할 수 있고 전원을 소비한다는 점이다. WiFi가 제공하는 퍼포먼스가 필요하지 않다면 소비전력이 높기때문에 다른 무선 기술을 사용하는 것이 낫다.

### 장거리 셀룰러
제품을 클라우드에 접속시켜야 한고 WiFi AP가 따로 없다면 제품은 장거리 통신을 하기위한 셀룰러 통신이 필요할 것이다.  셀룰러 기술 타입은 데이터 전송속도가 얼마나 빨라야하는지, 제품 판매지가 어디냐에 따라 다르겠다.

- GSM/GPRS(General Packet Radio Service): 데이터를 전송하기 위한 GRPS와 연결된 GSM은 오랫동안 많은 양의 데이터를 요구하지 않는 셀룰러 기술에서 사용되어왔다. 넓은 가용성과 상대적으로 낮은 GSM/GPRS 하드웨어 가격때문에 사용한다. 아쉽지만 이 기술은 끝을 보고 있다. 세계적으로 대부분의 cellular carrier는 단계적으로 GSM을 줄여가는 추세이며 많은 양의 데이터 교환을 할 수 있는 4G/5G 대역을 제공하는 중이다. 적어도 아직까지는 명확한 대체기술이 없다. 아마 옵션이라면 GSM 솔루션을 LTE 셀룰러 기술로 하드웨어를 업그레이드하는 것일 것이다. 다만 비용이 크게 증가한다.

- LTE: GSM보다 빠른 전송속도를 지원한다. 제품이 빠른 셀룰러 전송속도를 요구한다면 LTE는 최고의 선택일 것이다. 임베디드 GSM 모듈은 중국에서 몇 달러만으로도 구입할 수 있는 반면 LTE는 20달러 이상한다. IoT 디바이스의 인기에 기술 선택의 차이는 더욱 더 확실하게 되고 있다. 이 격차는 몇몇 새로운 무선 기술들로 채워지고 있는 과정이긴 하다.

### 저전력/장거리
IoT 기기로 장거리의 소량의 데이터 통신을 한다면 다른 애플리케이션처럼 기술선택을 확실하게 하기가 어렵다. 일반적으로 LPWAN이나 저전력 광범위 네트워크에 적용한다. 예를 들어 제품이 날씨 데이터를 원격으로 수집하고 자동으로 클라우드에 데이터를 업로드한다면 LPWAN이 필요하다. 느린 전송속도의 애플리케이션에는 GSM이나 LTE는 적합하지 않다. 아래의 기술들은 이에 좋은 솔루션이 되지만 국제 표준인 기술은 없다. 

- LoRa/LoRaWAN: 9km 이상의 매우 장거리 통신이 가능한 반면 전력 소비는 적다. 독점 기술(Semtech에서 2012년부터)이다. 지역별로 다른 대역폭을 사용하는데 북미에서는 915MHz를 사용하며 유럽에서는 868MHz를 사용한다. 다른 지역에서는 169MHz와 433MHz를 사용하고 있다. LoRa는 P2P 통신을 사용할 수 있는 기반 기술을 참조한다. LoRaWAN은 네트워크 프로토콜의 윗쪽 레이어를 사용한다. 저전력, 장거리, P2P 솔루션을 찾고 있다면 LoRa는 좋은 선택이다. 일반적으로 LoRa 모듈은 LoRaWAN 모듈보다 더 저렴하게 구입할 수 있다. LoRa는 아주 넓은 범위에서 작동시키기 위해 디자인되었으며, 모바일 네트워크에 접속할 수 있는 셀룰러 기술이 아니다. 덜 복잡하고 설치하기 저렴하지만 사용할 수 있는 애플리케이션이 한정되어있다. 예를 들어, 상품이 클라우드로의 장거리 접근을 필요로 하면 인터넷에 연결하고 어떤 원격 LoRa 디바이스와도 통신할 수 있는 LoRa 게이트웨이 디바이스를 사용해야 한다.  작동 범위 안에 LoRa 게이트웨이가 없다고 가정한다면, LoRa는 단일 원격 디바이스에 원격으로 클라우드에 접근하는 방법을 제공하지 않는다.

- NB-IOT: 셀룰러 기술이라 더 복잡하고 설치하기 비용이 많이 들고 더 많은 전력을 소비한다. 하지만 높은 퀄리티의 셀룰러 연결을 제공하고 인터넷에 곧바로 접근할 수 있다. NB-IOT의 가장 큰 단점은 가용성이 한정되어있다는 점이다. 미국에서는   아직 지원하지 않고 있으며 현재 유럽에서 시험 중에 있다. 하지만 2019년 중으로는 미국에서 사용 가능할 것으로 예측된다. 제품에 현재 설치하기에는 적합하지 않지만 몇 년 안에 가능 하게 될 것이다.

- LTE-M: 제품이 빠른 데이터 전송률을 가진 장거리 셀룰러가 필요하다면 LTE-M은 최고의 선택지이다. LTE-M은 LTE Cat-M1의 약자이다. 이 기술은 4G 모바일 네트워크로 바로 연결할 필요가 있는 IoT 디바이스를 위한 기술이다. LTE의 부분집합인 기술로 저전력으로 동작하는 낮은 데이터 전송속도를 가진 디바이스에 최적화되어있다. LTE-M은 표준 LTE기술과는 몇몇 결정적인 부분이 다르다. 첫번째로 더 제한된 대역폭에서 사용하는 간단한 구조의 칩때문에 설치 비용이 저렴하다. 두번째로 적은 배터리를 빠르게 소모하면 안되기때문에 전력 소비를 줄이는 것에 최적화되어있다. 마지막으로 어디서나 표준 LTE에서 제공하는 것에 가까운 대역폭을 사용하지 않으므로 셀룰러 서비스가 비용이 상당히 덜 든다.

## CONCLUSION
아래의 기준들은 통신 거리를 늘리면 전원 소비량도 늘어나는 식의, 데이터 전송속도를 올리거나 데이터 전송 빈도를 늘리면 마찬가지로 트레이프-오프가 있다. 최고의 솔루션이란 없으니 기준들로 우선순위를 정해 제품을 디자인해야 한다. 사용할 프로토콜을 정해야 그 다음 스탭을 밟을 수 있으니 IoT 제품 개발중 가장 중요한 부분이라고 본다.

- 작동 거리 ⬆️: LTE, LTE-M, LoRa/LoRaWAN, NB-IOT
- 데이터 전송속도 ⬆️: LTE, LTE-M, WiFi
- 전원 소비 ⬇️: BLE, Zigbee, Z-Wave, LoRa/LoRaWAN, NB-IOT, LTE-M
- 가격 ⬇️: WiFi
- 연결 가능 기기 ⬆️: BLE, Zigbee, Z-Wave

P2P 타입은 1:1로만 연결이 가능하기 때문에 제외하고 GSM/GPRS도 사장되고 있는 기술이므로 유지관리를 위해서는 사용하기 적합하지 않으므로 제외하면 BLE, Z-Wave, Zigbee, 6LoWPAN, WiFi, LTE, LoRa/LoRaWAN, NB-IOT, LTE-M이란 9개 선택지가 남는다.