---
layout: post
title: Nodejs excel 라이브러리 비교
author: Yangeok
categories: Node.js
date: 2020-08-22 09:00
comments: true
tags: [excel]
cover:
---

##

[npm trends](https://www.npmtrends.com/exceljs-vs-xlsx)를 보면 xlsx가 다운로드 수가 더 많은 것을 확인할 수 있다.

star는 xlsx가 22k로 더 많다. 업데이트 속도는 비슷해보인다. 번들파일 사이즈는 exceljs가 64.9kb더 작다.

자, 이제 readme나 예제를 보면서 라이브러리를 분석해보자.

exceljs 
  weekly downloads 179k

  csv, json까지 i/o할 수 있음
  6년전 최초 릴리즈
  [클라이언트 사이드 사용가능](https://github.com/exceljs/exceljs/issues/768)
  스트림 설정이 간단함
  ```js
  const workbook = new Excel.Workbook();
  const worksheet = await workbook.csv.read(stream);
  ```

xlsx
  weekly downloads 784k

  더 다양한 포맷을 i/o할 수 있음
  7년전 최초 릴리즈
  클라이언트 사이드 사용가능
  스트림 설정이 어려움

  ```js
  var fs = require('fs');
  var XLSX = require('xlsx');
  function process_RS(stream/*:ReadStream*/, cb/*:(wb:Workbook)=>void*/)/*:void*/{
    var buffers = [];
    stream.on('data', function(data) { buffers.push(data); });
    stream.on('end', function() {
      var buffer = Buffer.concat(buffers);
      var workbook = XLSX.read(buffer, {type:"buffer"});
  
      /* DO SOMETHING WITH workbook IN THE CALLBACK */
      cb(workbook);
    });
  }
  ```

xlsx의 장점은 다양한 파일포맷 i/o인데 그만큼 필요가 없고, 사용법이 어려우므로 exceljs를 선택했다. 모바일 플랫폼인 rn에서도 사용가능하다는데 딱히 여기서 엑셀 파일을 생성할 필요가 없어보였다. 파일 작성같은 작업은 faas로 하는게 안전하고 맘도 편하니깐. 스트림도 쓰려면 